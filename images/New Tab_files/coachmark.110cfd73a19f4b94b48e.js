(window.webpackJsonp=window.webpackJsonp||[]).push([["coachmark"],{QnRU:function(e,t,a){"use strict";a.d(t,"a",(function(){return I})),a.d(t,"c",(function(){return w})),a.d(t,"b",(function(){return S}));var r=a("D57K"),i=a("tMmC"),n=a("a0gC");const s=new class{getAllCampaigns(){return new Promise(e=>Object(r.b)(this,void 0,void 0,(function*(){try{(yield n.a.isUserNurturingApiAvailableToUse())?n.a.getUserNurturingPreferenceSetting("campaigns").then(t=>{t||i.a.logError("PSL: window.chrome.ntpSettingsPrivate.getPref does not have campaigns."),e(t||[])}):(i.a.logError("PSL: Error fetching campaigns due to window.chrome.ntpSettingsPrivate.getPref api not available for this version of EDGE"),e([]))}catch(t){i.a.logError(t),e([])}})))}persistCampaigns(e){return new Promise(t=>Object(r.b)(this,void 0,void 0,(function*(){try{(yield n.a.isUserNurturingApiAvailableToUse())?(yield n.a.saveUserNurturingPreferenceSetting("campaigns",e),i.a.log(`PSL: Number of campaigns persisted: ${e.length||0}.`),t(!0)):i.a.logError("PSL: Error persisting campaigns due to window.chrome.ntpSettingsPrivate.getPref api not available for this version of EDGE")}catch(e){i.a.logError(e)}t(!1)})))}clearPersistentStorage(){return this.persistCampaigns([])}};var o=a("dTwT");const c=new class{constructor(){this.storageKey="irisNewsLocalStorage"}getAllCampaigns(){try{return Object(o.a)().getObject(this.storageKey)}catch(e){return i.a.logError(`Exception ${e} occurred retrieving user nurturing campaigns from local storage`),[]}}storeCampaigns(e){try{return Object(o.a)().setObject(this.storageKey,e),i.a.log(`Number of campaigns persisted in local storage: ${e.length||0}.`),!0}catch(e){return i.a.logError(`Exception ${e} occurred storing user nurturing campaigns in local storage`),!1}}clearLocalStorage(){return this.storeCampaigns([])}};var h=a("HxRh"),d=a("rvYQ"),l=a("ADRF"),p=a("ax+D"),m=a("y+Kz"),u=a("I6Lx"),g=a("ypwz"),b=a("s9+9"),f=a("KRKw"),k=a("tERu"),C=a("ljWX"),v=a("VZ41"),E=a("XgsJ"),O=a("HDSB"),y=a("9J8d"),T=a("gqHb"),x=a("XLvf");const I=new class{constructor(){this.cachedSurfaceMap=new Map,this.irisSessionContextAttributes=new Map,this.enabledFeatures=[],this.millisecondsInADay=864e5,this.timeNow=(new Date).getTime(),this.appType=d.b&&d.b.AppType,this.appType===g.a.EdgeChromium&&this.getConfigDataAsync()}get isEnabled(){return!!this.shouldUseCache()||!(!this.irisDataConfig||!this.irisDataConfig.enableCaching)&&this.isCookieConsentNotRequired()}set IrisDataConfig(e){this.irisDataConfig=e}clearCachedSurfaceMap(){this.isEnabled&&this.cachedSurfaceMap.clear()}populateCachedSurfaceMap(){return Object(r.b)(this,void 0,void 0,(function*(){if(this.isEnabled)try{if(this.purgeCacheWithQsp())return yield this.clearCachedSurfacesFromStorage(),void i.a.log("Cache purged!");this.clearCachedSurfaceMap();let e=[];if(e=d.b.AppType===g.a.EdgeChromium?yield s.getAllCampaigns():c.getAllCampaigns(),!e||0===e.length)return void i.a.log("Bulk read of surfaces from local/persistent storage didn't return a surface.");const{subscribers:t}=this.irisDataConfig,a=[];Object.keys(t).forEach(e=>{t[e].active||a.push(C.c[e])}),e.forEach(e=>{e&&e.placement&&(0===a.length||-1===a.indexOf(e.placement))&&(i.a.log(`Populated ${e.placement} from local/persistent storage.`),this.cachedSurfaceMap.set(e.placement,e),this.highestLastAddedTime=0,e.creatives&&e.creatives.length>0&&e.creatives.forEach(e=>{e&&e.storageInfo&&e.storageInfo.lastAddedTime&&(this.highestLastAddedTime=e.storageInfo.lastAddedTime>=this.highestLastAddedTime?e.storageInfo.lastAddedTime:this.highestLastAddedTime)}))})}catch(e){i.a.logError("Bulk read of surfaces from local/persistent storage threw error: "+e)}}))}getLatestCachedSurface(e,t){if(!e||0===e.length||0===this.cachedSurfaceMap.size)return null;if(!this.cachedSurfaceMap.has(e))return null;const a=this.cachedSurfaceMap.get(e);if(!a||!a.creatives||0===a.creatives.length)return null;if(t!==C.d.MSNAnaheimNewsNTPImages)return a;const r=this.getStorageCachingExpiration();let i=!1;return a.creatives.forEach(e=>{e&&e.storageInfo&&e.storageInfo.lastAddedTime&&this.timeNow-e.storageInfo.lastAddedTime<r&&(i=!0)}),i?a:null}addSurfaceToMap(e){if(!e||!e.placement)return;const t=e.placement,a=new Map;if(this.cachedSurfaceMap.has(t)){this.cachedSurfaceMap.get(t).creatives.forEach(e=>{a.set(e.creativeId,e)})}e.creatives&&e.creatives.forEach(e=>{const t={useCount:0,lastAddedTime:this.timeNow};e.storageInfo=t,a.set(e.creativeId,e)}),e.creatives=[...a.values()],i.a.log(`Adding SurfaceInfo ${t} in storage.`),this.cachedSurfaceMap.set(t,e)}addSurfaceCollectionToStorage(e){return Object(r.b)(this,void 0,void 0,(function*(){e&&e.length>0&&(e.forEach(e=>{e.placement!==C.c[C.d.MSNAnaheimNewsNTPImages]&&e.placement!==C.c[C.d.MSNAnaheimNewsNTPImages+C.b]&&this.addSurfaceToMap(e)}),yield this.persistAllSurfaces())}))}persistAllSurfaces(){return Object(r.b)(this,void 0,void 0,(function*(){if(this.isEnabled){if(d.b.AppType===g.a.EdgeChromium)return void(yield s.persistCampaigns([...this.cachedSurfaceMap.values()]));c.storeCampaigns([...this.cachedSurfaceMap.values()])}}))}clearCachedSurfacesFromStorage(){return Object(r.b)(this,void 0,void 0,(function*(){this.isEnabled&&(this.clearCachedSurfaceMap(),d.b.AppType!==g.a.EdgeChromium?c.clearLocalStorage():yield s.clearPersistentStorage())}))}getCachedSurfaceMap(){return this.cachedSurfaceMap}HaveWeShownASurfaceRecently(){return this.highestLastAddedTime>0&&this.timeNow-this.highestLastAddedTime<this.getTimeBetweenShowingDifferentCreatives()}isUserSeenAllCreativesInSurface(e){if(!e||0===e.length)return!1;if(this.cachedSurfaceMap.has(e)){const t=this.cachedSurfaceMap.get(e);let a=0;if(t&&t.creatives&&t.creatives.length>0)return t.creatives.forEach(e=>{e.storageInfo&&e.storageInfo.useCount&&e.storageInfo.lastAddedTime&&(e.storageInfo.useCount>=this.getReshowingCounterForEachCreative()||this.timeNow-e.storageInfo.lastAddedTime<=this.getTimeBetweenReshowingSameCreative())&&a++}),t.creatives.length===a}return!1}filterCreatives(e){if(!e||!this.shouldUseMaximumCapPerCreative())return e;const t=this.irisDataConfig&&this.irisDataConfig.maximumCapPerCreative||2,a=[];return e.creatives.forEach(e=>{e.storageInfo&&e.storageInfo.useCount<=t&&a.push(e)}),e.creatives=a,e}updateAction(e,t,a){if(e&&t&&this.cachedSurfaceMap.has(e)){const r=this.cachedSurfaceMap.get(e);r&&r.creatives&&r.creatives.forEach(e=>{e.creativeId===t&&e.storageInfo&&(e.storageInfo.irisAction=a)})}}markCreativeAsSeenByUser(e,t){if(e&&t&&this.cachedSurfaceMap.has(e)){const a=this.cachedSurfaceMap.get(e);a&&a.creatives&&a.creatives.forEach(e=>{e&&e.creativeId&&e.creativeId===t&&e.storageInfo&&(e.storageInfo.useCount++,e.storageInfo.lastAddedTime=this.timeNow)})}}hasUserDismissedAllStoredSurfaceCreatives(e){if(!e||0===e.length)return!1;if(this.cachedSurfaceMap.has(e)){const t=this.cachedSurfaceMap.get(e);let a=0;if(t&&t.creatives&&t.creatives.length>0)return t.creatives.forEach(e=>{if(!e.storageInfo||!e.storageInfo.irisAction||e.storageInfo.irisAction!==v.a.Dismiss)return!1;a++}),t.creatives.length===a}return!1}updateCreativeLatestAddedTime(e,t,a){if(!this.cachedSurfaceMap.has(e))return;const r=this.cachedSurfaceMap.get(e);r&&r.creatives&&0!==r.creatives.length&&r.creatives.forEach(e=>{e&&e.creativeId===t&&e.storageInfo&&e.storageInfo.lastAddedTime&&(e.storageInfo.lastAddedTime=a)})}getStorageCachingExpiration(){return(this.irisDataConfig&&this.irisDataConfig.storageCachingExpiration||1)*this.millisecondsInADay}getReshowingCounterForEachCreative(){return this.irisDataConfig&&this.irisDataConfig.frequency||2}getTimeBetweenReshowingSameCreative(){return(this.irisDataConfig&&this.irisDataConfig.frequencyInterval||14)*this.millisecondsInADay}getTimeBetweenShowingDifferentCreatives(){return(this.irisDataConfig&&this.irisDataConfig.frequencyIntervalBetweenCreatives||1)*this.millisecondsInADay}purgeCacheWithQsp(){const e=Object(E.m)();if(e){const t=l.a.getQueryParameterByName("purgeCache",e);if(t&&"true"===t.toLocaleLowerCase())return!0}return!1}shouldUseCache(){const e=Object(E.m)();if(e){const t=l.a.getQueryParameterByName("useCache",e);if(t)return"true"===t.toLocaleLowerCase()}return!1}shouldUseMaximumCapPerCreative(){const e=Object(E.m)();if(e){const t=l.a.getQueryParameterByName("useMaxCapPerCreative",e);if(t)return"true"===t.toLocaleLowerCase()}return!0}isCookieConsentNotRequired(){const e=y.a.getInstance().rootReducer.connector(b.a.SharedState),t=e&&e.getCurrentState();return(t&&t.cookieConsentStatus)===f.b.NotRequired}getConfigDataAsync(){return Object(r.b)(this,void 0,void 0,(function*(){return this.getConfigDataPromise=new Promise(e=>{try{Object(O.a)()&&window&&window.chrome&&window.chrome.ntpSettingsPrivate&&"function"==typeof window.chrome.ntpSettingsPrivate.getConfigData?window.chrome.ntpSettingsPrivate.getConfigData(t=>{void 0!==t?(this.profileCreationTimeInMs=t.profileCreationTime,this.enabledFeatures=t.enabledFeatures,this.getIrisSessionContextAttributes(t.irisAttributes),this.configData=t,e()):(T.a.trackAppErrorEvent(Object.assign(Object.assign({},h.ab),{message:"Config data is undefined"})),e())}):(T.a.trackAppErrorEvent(Object.assign(Object.assign({},h.Kb),{message:"Failed to fetch config data from chromium API"})),e())}catch(t){T.a.trackAppErrorEvent(Object.assign(Object.assign({},h.Fb),{message:"Exception fetching config data from chromium API",pb:Object.assign(Object.assign({},h.Fb.pb),{customMessage:"Exception: "+t})})),e()}}),this.getConfigDataPromise}))}isBlackoutPeriodOver(){return Object(r.b)(this,void 0,void 0,(function*(){this.appType===g.a.EdgeChromium&&(yield this.getConfigDataPromise);const e=this.irisDataConfig.blackoutPeriodInDays&&this.irisDataConfig.blackoutPeriodInDays*this.millisecondsInADay||7*this.millisecondsInADay;return!!this.profileCreationTimeInMs&&this.timeNow-this.profileCreationTimeInMs>e}))}getIrisSessionContextAttribute(e){return Object(r.b)(this,void 0,void 0,(function*(){return this.appType===g.a.EdgeChromium&&(yield this.getConfigDataPromise),this.irisSessionContextAttributes.has(e)?this.irisSessionContextAttributes.get(e):""}))}getIrisSessionContextAttributes(e){if(p.a.isNotNullOrUndefined(e)&&e.length>0){e.startsWith("&")&&e.length>=1&&(e=e.substring(1));e.split("&").map(e=>e.split("=")).forEach(e=>{this.irisSessionContextAttributes.set(e[0],e[1])})}}isDefaultBrowserUpsellEnabled(){return Object(r.b)(this,void 0,void 0,(function*(){return this.appType===g.a.EdgeChromium&&(yield this.getConfigDataPromise),!!this.enabledFeatures&&this.enabledFeatures.indexOf("msNtpSpotlightSetEdgeAsDefault")>=0}))}isNurturingEnabled(){return Object(r.b)(this,void 0,void 0,(function*(){return this.appType===g.a.EdgeChromium&&(yield this.getConfigDataPromise),!!this.enabledFeatures&&this.enabledFeatures.indexOf("msUserNurturing")>=0}))}getConfigData(){return this.configData}};function w(){return Object(r.b)(this,void 0,void 0,(function*(){if(yield S())return!1;try{return!1!==Object(o.a)().getObject(m.t)}catch(e){return T.a.trackAppErrorEvent(Object.assign(Object.assign({},h.Ob),{message:"Failed to fetch nurturing accepted key from local storage",pb:Object.assign(Object.assign({},h.Ob.pb),{customMessage:`Exception: ${e} occurred while reading key: ${m.t} from local storage.`})})),!1}}))}function S(){return Object(r.b)(this,void 0,void 0,(function*(){yield d.b.AccountInfoPromise;const e=d.b.ResolvedAccountInfo;return Object(x.isNullOrUndefined)(u.b.AadState)?k.b.AAD===(e&&e.account_type):u.b.AadState}))}},U6Xm:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("G82u");class i{}i.addCoachmark=new r.a("AddCoachmark"),i.updateCoachmarkVisibleStatus=new r.a("UpdateCoachmarkVisibleStatus")},"W3b/":function(e,t,a){"use strict";a.r(t),a.d(t,"Coachmark",(function(){return oe})),a.d(t,"CoachmarkActions",(function(){return W.a})),a.d(t,"CoachmarkInspector",(function(){return K})),a.d(t,"CoachmarkConnector",(function(){return ne})),a.d(t,"CoachmarkReducer",(function(){return Q})),a.d(t,"CoachmarkReduxSubspaceName",(function(){return H})),a.d(t,"ToolingInfo",(function(){return ce}));var r=a("D57K"),i=a("HxRh"),n=a("5mwN"),s=a("rcIs"),o=a("VZ41");var c=a("3ZGc"),h=a("rRWH"),d=a("1I/+"),l=a("ax+D"),p=a("Am8i"),m=a("FPTP"),u=a("y2Il"),g=a("SP+O"),b=a("MZhw"),f=a("objN"),k=a("mDtb"),C=a("LD6M"),v=a("aP31"),E=a("9CwC"),O=a("X9F+"),y=a("qibw"),T=a("0fst");var x=a("Gy7L"),I=a("kpPY"),w=a("gQ7Y"),S=a("ERkP"),A=a.n(S),j=a("7nmT"),P=a.n(j),M=a("tMmC"),D=a("Gil3"),L=a("0PLU"),N=a("keKk"),B=a("u5KZ");const $=(e,t)=>{switch(e.ctaType){case U.launchAndDefaultWebWidget:return()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(t.hideCoachmark);const e=Object(D.d)(t.currentLayout);e&&e()}));case U.openAddDialog:return F(t);case U.pinMsnews:return()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(t.hideCoachmark);const e=Object(D.g)();e&&e()}));case U.tryInformationalMode:return()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(t.hideCoachmark);const e=Object(D.h)(t.delayInMs);e&&e()}));case U.tryInformationalModeProg:return()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(t.hideCoachmark);const e=Object(D.j)(t.delayInMs);e&&e()}));case U.tryInformationalModeDirect:return()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(t.hideCoachmark);const e=Object(D.i)();e&&e()}));case U.tryVoiceSearch:return()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(t.hideCoachmark);const e=Object(D.b)();e&&e()}));default:B.a.sendAppErrorEvent(Object.assign(Object.assign({},i.O.InvalidCTAType),{message:"CTA type is invalid or not found.",pb:Object.assign(Object.assign({},i.O.InvalidCTAType.pb),{customMessage:`CTA type: ${e.ctaType} is invalid `})}))}},F=e=>()=>Object(r.b)(void 0,void 0,void 0,(function*(){R(e.hideCoachmark);const t=e.delayInMs||2e3;let a;const r=L.a[L.b.clickAddTileButton];r&&(a=yield r({})),M.a.log(`Action completed: ${a.actionCompleted} status: ${a.status}`),yield Object(N.a)(t);const i=e.updateCoachmark;i&&i()}));function R(e){e&&e()}var U;!function(e){e.launchAndDefaultWebWidget="launchAndDefaultWebWidget",e.openAddDialog="openAddDialog",e.pinMsnews="pinMsnews",e.tryVoiceSearch="tryVoiceSearch",e.tryInformationalMode="tryInformationalMode",e.tryInformationalModeDirect="tryInformationalModeDirect",e.tryInformationalModeProg="tryInformationalModeProg"}(U||(U={}));class z extends n.a{constructor(e){super(e),this.handledProps=Object.assign(Object.assign({},n.b),{actionPauseInMs:void 0,addCoachmarkMessages:void 0,addCoachmarkToPage:void 0,bodyText:void 0,bodyTextSize:void 0,coachmarkPlaced:void 0,coachmarkSource:void 0,contentModuleExperienceName:void 0,creativeId:void 0,ctaList:void 0,currentLayout:void 0,currentMessageIndex:void 0,dismissButtonAriaLabelText:void 0,disablePointer:void 0,displayType:void 0,ecsFeatureFlags:void 0,eventUrl:void 0,hideCoachmark:void 0,isTmplStampingRequired:void 0,isEcsExperiment:void 0,leadImage:void 0,leadImageAltText:void 0,mainImage:void 0,mainImageAltText:void 0,managedClasses:void 0,name:void 0,nonTargetPlacement:void 0,placement:void 0,placementId:void 0,pointerPosition:void 0,removeCoachmarkFromPage:void 0,renderCoachmark:void 0,reportEvent:void 0,retrieveInitialEligibilityStateOfCampaign:void 0,rewardsInfo:void 0,rootTelemetryObject:void 0,tabIndex:void 0,targetElement:void 0,timeoutMilliseconds:void 0,timeoutTriggered:void 0,titleText:void 0,titleTextSize:void 0,trackAppErrorEvent:void 0,trackEvent:void 0,trackPartialImpressionEvent:void 0,updateCoachmark:void 0,updateTemplValue:void 0,zIndex:void 0}),this.currentPointerTopOffset=0,this.currentPointerLeftOffset=0,this.currentLangDir=document.dir,this.windowUpdateEventCallback=()=>{window.requestAnimationFrame(()=>{this.updateCoachmarkPosition(this.props.placement),this.updateCloseButtonPosition()})},this.windowClickEventCallback=e=>{if(this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.getBoundingClientRect){const t=this.coachmarkElement.current.getBoundingClientRect();!(e.clientX&&e.clientY&&e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom)&&this.props.addCoachmarkToPage&&(this.userInteractedWithCoachmark||(this.stampTMPLTag(`ClickedAwayFromCoachmark_${this.props.contentModuleExperienceName}:1`),this.sendTelemetryEvent("click_nonnav","ClickedAwayFromCoachmark_"+this.props.contentModuleExperienceName,this.coachmarkElement.current,"",p.a.Click,p.b.Hide)),this.props.hideCoachmark())}return e},this.closeCoachmark=(e,t,a,i,n)=>Object(r.b)(this,void 0,void 0,(function*(){n||this.sendTelemetryEvent("click_nonnav","Dismiss",e.currentTarget,"",a,i),this.props.coachmarkSource===s.e.Iris&&this.props.reportEvent(o.b.Action,this.props.eventUrl,t,this.props.creativeId,this.props.placementId),this.props.removeCoachmarkFromPage(),this.cleanup()})),this.keyDownHandler=e=>{e.keyCode===x.h&&this.closeCoachmark(e,o.a.Dismiss,p.a.Click,p.b.Hide)},this.lastElementKeyDownHandler=(e,t,a,r,i)=>{e.keyCode===x.m?e.shiftKey?(e.preventDefault(),P.a.findDOMNode(this.coachmarkCTAButtonElement.current).focus()):(e.preventDefault(),P.a.findDOMNode(this.coachmarkCloseElement.current).focus()):e.keyCode===x.g&&this.closeCoachmark(e,t,a,r,i)},this.closeButtonKeyDownHandler=(e,t,a,r)=>{if(e.keyCode===x.m&&this.props.ctaList)if(e.shiftKey){e.preventDefault();const t=this.coachmarkDismissButtonElement.current?this.coachmarkDismissButtonElement.current:this.coachmarkCTAButtonElement.current;P.a.findDOMNode(t).focus()}else e.preventDefault(),P.a.findDOMNode(this.coachmarkCTAButtonElement.current).focus();else e.keyCode===x.g&&this.closeCoachmark(e,t,a,r)},this.ctaButtonHandler=(e,t,a)=>{this.userInteractedWithCoachmark=!0;((e,t,a)=>{const{ctaType:n}=e;if(n)if(t){if(a)return()=>Object(r.b)(void 0,void 0,void 0,(function*(){t.coachmarkSource===s.e.Iris&&t.reportEvent(o.b.Action,t.eventUrl,t.irisAction,t.creativeId,t.placementId);const a=$(e,t);return a?yield a():null}));B.a.sendAppErrorEvent(Object.assign(Object.assign({},i.O.EventNotDefined),{message:"Event is not defined"}))}else B.a.sendAppErrorEvent(Object.assign(Object.assign({},i.O.CoachmarkStateNotDefined),{message:"Coachmark state is not defined"}));else B.a.sendAppErrorEvent(Object.assign(Object.assign({},i.O.CTATypeNotDefined),{message:"CTA type is not defined"}))})(e,{creativeId:this.props.creativeId,coachmarkSource:this.props.coachmarkSource,currentLayout:this.props.currentLayout,delayInMs:this.props.actionPauseInMs,eventUrl:this.props.eventUrl,hideCoachmark:this.props.hideCoachmark,irisAction:a,name:this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"COACHMARK",placementId:this.props.placementId,reportEvent:this.props.reportEvent,trackEvent:this.props.trackEvent,updateCoachmark:this.props.updateCoachmark},t)()},this.ctaButtonKeyDownHandler=(e,t,a)=>{if(t.keyCode===x.m)if(t.shiftKey)t.preventDefault(),P.a.findDOMNode(this.coachmarkCloseElement.current).focus();else{t.preventDefault();const e=this.coachmarkDismissButtonElement.current?this.coachmarkDismissButtonElement.current:this.coachmarkCloseElement.current;P.a.findDOMNode(e).focus()}else t.keyCode===x.g&&this.ctaButtonHandler(e,t,a)},this.coachmarkElement=A.a.createRef(),this.coachmarkCloseElement=A.a.createRef(),this.coachmarkPointerElement=A.a.createRef(),this.coachmarkCTAButtonElement=A.a.createRef(),this.coachmarkDismissButtonElement=A.a.createRef(),this.isCurrentlyVisible=!1}componentDidUpdate(){super.componentDidUpdate(),this.initCoachmark()}componentDidMount(){super.componentDidMount(),this.initCoachmark(),this.coachmarkCloseElement.current&&P.a.findDOMNode(this.coachmarkCloseElement.current).focus()}render(){if(super.render(),!this.props.addCoachmarkToPage)return this.cleanup(),A.a.createElement("div",{id:z.emptyCoachmarkPageId});const{coachmark_default:e,coachmark_title:t,coachmark_body:a,coachmark_content:r}=this.props.managedClasses;return this.coachmarkTelemetryObject=this.props.rootTelemetryObject?this.props.rootTelemetryObject.addOrUpdateChild({name:this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"Coachmark",content:{headline:this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"Coachmark",type:p.c.Coachmark}}):null,A.a.createElement("div",Object.assign({},this.unhandledProps(),{id:z.mainElementPageId,ref:this.coachmarkElement,className:e,"aria-hidden":!this.isCurrentlyVisible,tabIndex:this.props.tabIndex?this.props.tabIndex:-1,style:{width:this.getCoachmarkWidth(this.props.displayType),zIndex:this.props.zIndex}},this.coachmarkTelemetryObject.render(),{onKeyDown:this.keyDownHandler}),this.props.disablePointer?null:this.renderPointer(this.props.placement),A.a.createElement("div",null,this.renderMainImage(),A.a.createElement("div",{className:r},this.renderLeadImage(),A.a.createElement("div",{id:z.titleTextElementPageId,className:t},A.a.createElement(m.a,{size:this.props.titleTextSize?this.props.titleTextSize:z.titleTextSize},this.props.titleText)),A.a.createElement("div",{id:z.bodyTextElementPageId,className:a},A.a.createElement(m.a,{size:this.props.bodyTextSize?this.props.bodyTextSize:z.bodyTextSize},this.props.bodyText))),this.renderCTAButtons()),this.renderCloseButton())}renderLeadImage(){return this.props.leadImage?A.a.createElement("img",{src:this.props.leadImage,className:this.props.managedClasses.coachmark_leadImage,alt:this.props.leadImageAltText}):null}renderMainImage(){return this.props.mainImage?A.a.createElement("img",{alt:this.props.mainImageAltText,className:this.props.managedClasses.coachmark_mainImage,src:this.props.mainImage,style:{width:this.getImageWidth(this.props.displayType)}}):null}renderCTAButtons(){return this.props.ctaList?A.a.createElement("div",{className:this.props.managedClasses.coachmark_ctaButton_container},this.renderCTAButton(this.props.ctaList[0]),this.renderDismissButton(this.props.ctaList[1])):null}renderCTAButton(e){return e&&e.ctaText?A.a.createElement(w.default,Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:e.ctaText.replace(/\s/g,""),behavior:e.ctaBehavior?p.b[""+e.ctaBehavior]:p.b.View,content:{headline:e.ctaText.replace(/\s/g,""),type:p.c.Coachmark}}).render():null,{"aria-label":e.ctaText,title:e.ctaText,ref:this.coachmarkCTAButtonElement,className:this.props.managedClasses.coachmark_ctaButton,onClick:t=>this.ctaButtonHandler(e,t,o.a.Click),onKeyDown:t=>this.ctaButtonKeyDownHandler(e,t,o.a.Click)}),e.ctaText):null}renderDismissButton(e){return e&&e.ctaText?A.a.createElement(w.default,Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:e.ctaText.replace(/\s/g,""),behavior:e.ctaBehavior?p.b[""+e.ctaBehavior]:p.b.Close,content:{headline:e.ctaText.replace(/\s/g,""),type:p.c.Coachmark}}).render():null,{"aria-label":e.ctaText,title:e.ctaText,ref:this.coachmarkDismissButtonElement,className:this.props.managedClasses.coachmark_dismissButton,onClick:e=>this.closeCoachmark(e,o.a.Dismiss,p.a.Click,p.b.Hide,!0),onKeyDown:e=>this.lastElementKeyDownHandler(e,o.a.Dismiss,p.a.Click,p.b.Hide,!0)}),e.ctaText):null}renderCloseButton(){const{coachmark_close:e}=this.props.managedClasses;return A.a.createElement("div",Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:"Dismiss",behavior:p.b.Close,content:{headline:"Dismiss",type:p.c.Coachmark}}).render():null,{id:z.closeElementPageId,ref:this.coachmarkCloseElement,"aria-label":this.props.dismissButtonAriaLabelText,onClick:e=>this.closeCoachmark(e,o.a.Dismiss,p.a.Click,p.b.Close),onKeyDown:e=>this.closeButtonKeyDownHandler(e,o.a.Dismiss,p.a.Click,p.b.Close),tabIndex:0}),A.a.createElement("svg",{className:e},A.a.createElement("path",{d:"M12.708 12L17 16.292L16.292 17L12 12.708L7.70801 17L7 16.292L11.292 12L7 7.70801L7.70801 7L12 11.292L16.292 7L17 7.70801L12.708 12Z"})))}renderPointer(e){return"128000000002304969"==this.props.creativeId||"128000000002370389"==this.props.creativeId?null:A.a.createElement("svg",{id:z.pointerElementPageId,ref:this.coachmarkPointerElement,className:this.props.managedClasses.coachmark_ptr,height:this.props.placement===s.b.Left||this.props.placement===s.b.Right?z.pointerBaseSize:z.pointerExtendSize,width:this.props.placement===s.b.Left||this.props.placement===s.b.Right?z.pointerExtendSize:z.pointerBaseSize,style:{filter:this.getPointerDropShadow(e)}},A.a.createElement("polygon",{points:this.getPointerSVGPoints(e)}))}sendTelemetryEvent(e,t,a,r,i,n){this.props.trackEvent&&e&&a&&t&&this.props.trackEvent({type:e,target:a},a,r,t,i,n)}updateCloseButtonPosition(){const e=this.coachmarkElement&&null!=this.coachmarkElement.current,t=document.getElementById(z.closeElementPageId);e&&t&&(t.style.left=Object(c.a)(this.coachmarkElement.current.offsetWidth-24-4))}getPointerDropShadow(e){switch(e){case s.b.Above:return"drop-shadow(-1px 4px 1px rgba(0, 0, 0, 0.11))";case s.b.Below:return"drop-shadow(0px -1px 1px rgba(0, 0, 0, 0.11))";case s.b.Right:return this.currentLangDir===h.a.rtl?"drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))":"drop-shadow(-1.5px 2px 1px rgba(0, 0, 0, 0.11))";case s.b.Left:return this.currentLangDir===h.a.rtl?"drop-shadow(-1.5px 2px 1px rgba(0, 0, 0, 0.11))":"drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))";default:return null}}getPointerSVGPoints(e){switch(e){case s.b.Above:return"0,0 13,14 26,0";case s.b.Below:return"0,14 13,0 26,14";case s.b.Right:return"14,0 0,13 14,26";case s.b.Left:return"0,0 14,13 0,26";default:return null}}updatePointer(e,t){const a=this.coachmarkElement&&this.coachmarkElement.current?this.coachmarkElement.current:null,r=this.coachmarkElement&&this.coachmarkPointerElement.current?this.coachmarkPointerElement.current:null;if(!r||!a)return;let n=0,o=0;switch(e){case s.b.Above:n=a.offsetHeight-1;break;case s.b.Below:n=-14;break;case s.b.Right:o=-13;break;case s.b.Left:o=a.offsetWidth-2;break;default:return}if(e===s.b.Above||e===s.b.Below)switch(t){case s.c.Adjacent:o=16;break;case s.c.Center:o=a.offsetWidth/2-z.pointerBaseSize/2;break;case s.c.Opposite:o=a.offsetWidth-16-z.pointerBaseSize;break;default:return void this.trackAppErrorEvent(Object.assign(Object.assign({},i.O.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},i.O.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}else{if(e!==s.b.Right&&e!==s.b.Left)return;switch(t){case s.c.Adjacent:n=16;break;case s.c.Center:n=a.offsetHeight/2-z.pointerBaseSize/2;break;case s.c.Opposite:n=a.offsetHeight-16-z.pointerBaseSize;break;default:return void this.trackAppErrorEvent(Object.assign(Object.assign({},i.O.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},i.O.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}}this.currentPointerTopOffset=n,this.currentPointerLeftOffset=o,r.style.top=Object(c.a)(n),r.style[Object(h.b)("left","right",document.dir)]=Object(c.a)(o)}updateCoachmarkPosition(e){let t=0,a=0,r=0,n=0;const o=document.body.offsetWidth;if("128000000002304969"==this.props.creativeId||"128000000002370389"==this.props.creativeId){if(document.getElementById("museumCard")){const e=document.getElementById("museumCard").getBoundingClientRect(),t=e.right,a=e.top,r=this.coachmarkElement.current.getBoundingClientRect(),i=r.left,n=r.right;this.coachmarkElement.current.style.top=Object(c.a)(a-200),this.coachmarkElement.current.style.left=Object(c.a)(t-(n-i))}else this.coachmarkElement.current.style.top=Object(c.a)(50),this.coachmarkElement.current.style.left=Object(c.a)(50)}else if(this.targetElement&&this.targetElement.getBoundingClientRect&&this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.style){const r=this.targetElement.getBoundingClientRect();switch(e){case s.b.Above:t=r.top-(this.coachmarkElement.current.offsetHeight+z.pointerExtendSize+z.spaceBetweenCoachmarkAndTargetElement),a=this.currentLangDir===h.a.ltr?r.left+r.width/2-(this.currentPointerLeftOffset+16):o-(r.left+r.width/2+this.currentPointerLeftOffset+16);break;case s.b.Below:t=r.top+(r.height+z.pointerExtendSize+z.spaceBetweenCoachmarkAndTargetElement),a=this.currentLangDir===h.a.ltr?r.left+r.width/2-(this.currentPointerLeftOffset+16):o-(r.left+r.width/2+this.currentPointerLeftOffset+16);break;case s.b.Right:t=r.top+r.height/2-(this.currentPointerTopOffset+z.pointerBaseSize/2),a=this.currentLangDir===h.a.ltr?r.left+r.height+z.pointerExtendSize+z.spaceBetweenCoachmarkAndTargetElement:o-(r.left-z.pointerExtendSize-z.spaceBetweenCoachmarkAndTargetElement);break;case s.b.Left:t=r.top+r.height/2-(this.currentPointerTopOffset+z.pointerBaseSize/2),a=this.currentLangDir===h.a.ltr?r.left-(this.coachmarkElement.current.offsetWidth+z.pointerExtendSize+z.spaceBetweenCoachmarkAndTargetElement):o-(r.right+this.coachmarkElement.current.offsetWidth+z.pointerExtendSize+z.spaceBetweenCoachmarkAndTargetElement);break;default:return void this.trackAppErrorEvent(Object.assign(Object.assign({},i.O.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},i.O.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}}if(this.props.nonTargetPlacement){const i=10,c=this.targetElement&&this.targetElement.getBoundingClientRect&&this.targetElement.getBoundingClientRect();this.props.nonTargetPlacement!==s.f.TopStart&&this.props.nonTargetPlacement!==s.f.BottomStart||(a=this.targetElement&&e===s.b.Right?(this.currentLangDir===h.a.ltr?c.right:o-c.left)+i:i),this.props.nonTargetPlacement!==s.f.TopEnd&&this.props.nonTargetPlacement!==s.f.BottomEnd||(n=this.targetElement&&e===s.b.Left?(this.currentLangDir===h.a.ltr?o-c.left:c.right)+i:i,a=0),this.props.nonTargetPlacement!==s.f.TopStart&&this.props.nonTargetPlacement!==s.f.TopEnd||e===s.b.Below||(t=i),this.props.nonTargetPlacement!==s.f.BottomStart&&this.props.nonTargetPlacement!==s.f.BottomEnd||(r=this.targetElement&&e===s.b.Above?Object(d.b)(this.props.requestContext.data.innerHeight,"innerHeight")-c.top:i,t=0)}this.coachmarkElement.current.style.top=0!==t?Object(c.a)(t):"auto",this.coachmarkElement.current.style.bottom=0!==r?Object(c.a)(r):"auto",this.coachmarkElement.current.style[Object(h.b)("left","right",this.currentLangDir)]=0!==a?Object(c.a)(a):"auto",this.coachmarkElement.current.style[Object(h.b)("right","left",this.currentLangDir)]=0!==n?Object(c.a)(n):"auto"}initCoachmark(){return Object(r.b)(this,void 0,void 0,(function*(){if(this.props.addCoachmarkToPage)if(this.targetElement=this.findTargetElement(),this.targetElement||"128000000002304969"==this.props.creativeId||"128000000002370389"==this.props.creativeId||this.props.nonTargetPlacement){this.userInteractedWithCoachmark=!1,this.props.disablePointer||this.updatePointer(this.props.placement,this.props.pointerPosition),this.updateCoachmarkPosition(this.props.placement),this.updateCloseButtonPosition();const e=this.coachmarkFitsInViewport();if(e)return this.props.removeCoachmarkFromPage(),void this.trackAppErrorEvent(Object.assign(Object.assign({},i.O.NotPlaceable),{message:`Coachmark: ${this.props.contentModuleExperienceName} not placeable on user screen`,pb:Object.assign(Object.assign({},i.O.NotPlaceable.pb),{customMessage:`Error rendering coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}\n                        on user screen. ${e}`})}));if(window.addEventListener(z.windowEventResize,this.windowUpdateEventCallback,!1),window.addEventListener(z.windowEventScroll,this.windowUpdateEventCallback,!1),window.addEventListener(z.windowEventClick,this.windowClickEventCallback,!0),this.addAutoDismiss(),this.props.isTmplStampingRequired&&(this.stampTMPLTag(`userEligibleToSeeCoachmark_${this.props.contentModuleExperienceName}:1`),this.props.retrieveInitialEligibilityStateOfCampaign(this.props.creativeId)&&this.stampTMPLTag(`userEligibleToSeeCoachmark_${this.props.creativeId}:1`)),l.a.isNotNullOrUndefined(this.props.renderCoachmark)&&!this.props.renderCoachmark)return this.props.removeCoachmarkFromPage(),void this.stampTMPLTag(`coachmarkSuppressed_${this.props.contentModuleExperienceName}:1`);this.props.renderCoachmark&&this.props.isTmplStampingRequired&&this.stampTMPLTag(`coachmarkShown_${this.props.contentModuleExperienceName}:1`),this.props.coachmarkPlaced(this.props.contentModuleExperienceName,this.props.creativeId,this.props.placementId),this.props.trackPartialImpressionEvent&&"function"==typeof this.props.trackPartialImpressionEvent&&this.props.trackPartialImpressionEvent(this.coachmarkElement.current,!1,"partial",this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"coachmark_module_v2"),this.props.coachmarkSource===s.e.Iris&&this.props.reportEvent(o.b.Impression,this.props.eventUrl,void 0,this.props.creativeId,this.props.placementId)}else this.props.removeCoachmarkFromPage(),this.targetElement=null}))}stampTMPLTag(e){this.props.updateTemplValue&&"function"==typeof this.props.updateTemplValue?this.props.updateTemplValue(e):this.props.trackAppErrorEvent(Object.assign(Object.assign({},i.O.NotFoundComponent),{message:"TMPL function not found preventing stamp for coachmark: "+this.props.contentModuleExperienceName,pb:Object.assign(Object.assign({},i.O.NotFoundComponent.pb),{customMessage:`Error stamping TMPL tags due to undefined callback function\n                        Coachmark:  ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}addAutoDismiss(){if(this.props.timeoutMilliseconds&&this.props.timeoutMilliseconds>0){const e=this.props.currentMessageIndex;window.setTimeout(()=>{this.props.addCoachmarkToPage&&(this.stampTMPLTag(`CoachmarkAutoDismissed_${this.props.contentModuleExperienceName}:1`),this.sendTelemetryEvent("click_nonnav","CoachmarkAutoDismissed_"+this.props.contentModuleExperienceName,this.coachmarkElement.current,"",p.a.Click,p.b.Hide),this.props.timeoutTriggered(e))},this.props.timeoutMilliseconds)}}findTargetElement(){const e=document.querySelector(Object(I.a)("[{0}='{1}']",z.targetElementAttributeName,this.props.targetElement));return e||this.trackAppErrorEvent(Object.assign(Object.assign({},i.O.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark due to absent target element: ${this.props.targetElement} on page.`,pb:Object.assign(Object.assign({},i.O.GeneralError.pb),{customMessage:`Coachmark: ${this.props.contentModuleExperienceName} not rendered on user screen due to absent target element: ${this.props.targetElement} on page\n                         creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})})),e}coachmarkFitsInViewport(){if(!(window&&this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.getBoundingClientRect))return window?"Coachmark element not found or not able to retrieve coachmark size and relative position to viewport":"Window object undefined";const e=this.coachmarkElement.current.getBoundingClientRect(),t=Object(d.b)(this.props.requestContext.data.innerWidth,"innerWidth"),a=`top: ${e.top} bottom: ${e.bottom} left: ${e.left} right: ${e.right}`;return e.top<0?"Too Far Above. Exceeds Page Top. "+a:e.left<0?"Too Far Left. Exceeds Page Side. "+a:e.bottom>window.innerHeight||e.bottom>document.documentElement.clientHeight?"Too Far Below. Exceeds Page Bottom. "+a+` innnerHeight: ${window.innerHeight} clientHeight: ${document.documentElement.clientHeight}`:e.right>t||e.right>document.documentElement.clientWidth?"Too Far Right. Exceeds Page Side. "+a+` width: ${t} clientWidth: ${document.documentElement.clientWidth}`:null}cleanup(){this.isCurrentlyVisible=!1,this.targetElement=null,window.removeEventListener(z.windowEventResize,this.windowUpdateEventCallback),window.removeEventListener(z.windowEventScroll,this.windowUpdateEventCallback),window.removeEventListener(z.windowEventClick,this.windowClickEventCallback),this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.style&&(this.coachmarkElement.current.style.top="0",this.coachmarkElement.current.style.left="0")}trackAppErrorEvent(e){this.props.trackAppErrorEvent&&"function"==typeof this.props.trackAppErrorEvent&&this.props.trackAppErrorEvent(e)}getCoachmarkWidth(e){switch(s.d[e]){case s.d.Small:return"248px";case s.d.Medium:return"288px";case s.d.Large:return"368px";default:return"288px"}}getImageWidth(e){switch(s.d[e]){case s.d.Small:return"280px";case s.d.Medium:return"320px";case s.d.Large:return"400px";default:return"320px"}}}z.defaultProps={experienceName:"MsnCoachmark"},z.targetElementAttributeName="data-targetid",z.mainElementPageId="coachmark-v2",z.pointerElementPageId="coachmark-v2-ptr",z.titleTextElementPageId="coachmark-v2-titletxt",z.bodyTextElementPageId="coachmark-v2-bodytxt",z.closeElementPageId="coachmark-v2-close",z.emptyCoachmarkPageId="coachmark-v2-empty",z.titleTextSize=u.a._6,z.bodyTextSize=u.a._7,z.pointerBaseSize=26,z.pointerExtendSize=14,z.spaceBetweenCoachmarkAndTargetElement=2,z.windowEventResize="resize",z.windowEventScroll="scroll",z.windowEventClick="click";var _=a("05Au"),W=a("kLs4");const H="MsnCoachmark";class Q{reduce(e,t){if(!e)return{coachmarkMessageQueue:null,addCoachmarkToPage:!1,messageIndex:-1,contentModuleExperienceName:void 0};if(!t)return e;let a=null,r=!1;return r=_.a.handleAction(t,W.a.removeCoachmarkFromPage,()=>{a=Object.assign({},e),a.coachmarkMessageQueue=null,a.messageIndex=-1,a.addCoachmarkToPage=!1,a.contentModuleExperienceName=void 0}),r=r||_.a.handleAction(t,W.a.updateCoachmark,()=>{a=Object.assign({},e),a.messageIndex=a.messageIndex+1,a.addCoachmarkToPage=!0,a.contentModuleExperienceName=a.coachmarkMessageQueue[a.messageIndex].name}),r=r||_.a.handleAction(t,W.a.timeoutOccurred,t=>{t===e.messageIndex&&(a=Object.assign({},e),a.coachmarkMessageQueue=null,a.messageIndex=-1,a.addCoachmarkToPage=!1,a.contentModuleExperienceName=void 0)}),r=r||_.a.handleAction(t,W.a.addCoachmarkMessages,t=>{t&&t.length&&(e.coachmarkMessageQueue?"object"==typeof e.coachmarkMessageQueue&&e.coachmarkMessageQueue.length&&(a=Object.assign({},e),a.coachmarkMessageQueue.push(...t),(a.messageIndex<0||a.messageIndex>=a.coachmarkMessageQueue.length)&&(a.messageIndex=a.coachmarkMessageQueue.length-1)):(a=Object.assign({},e),a.coachmarkMessageQueue=t,a.messageIndex=0),a.contentModuleExperienceName=a.coachmarkMessageQueue[a.messageIndex].name,a.addCoachmarkToPage=!0)}),r=r||_.a.handleAction(t,W.a.hideCoachmark,()=>{a=Object.assign({},e),a.addCoachmarkToPage=!1}),a||e}}var K,V=a("+viU"),q=a("bZQK"),G=a("ypwz"),X=a("s9+9");(K||(K={})).inspect=function(e){const{config:t,state:a,connectorArgs:r}=e;let i=null;return a.addCoachmarkToPage&&a.coachmarkMessageQueue&&a.messageIndex>=0&&a.coachmarkMessageQueue[a.messageIndex]&&(i=a.coachmarkMessageQueue[a.messageIndex]),{props:Object.assign(Object.assign(Object.assign({},i),r),{titleTextSize:t.titleTextSize,bodyTextSize:t.bodyTextSize,dismissButtonAriaLabelText:t.accessibility.ariaLabel.dismissButton,currentMessageIndex:a.messageIndex,addCoachmarkToPage:!!i,tabIndex:t.tabIndex,eventUrl:i&&i.eventUrl?i.eventUrl:void 0,rootTelemetryObject:r.telemetryObject,contentModuleExperienceName:a.contentModuleExperienceName?a.contentModuleExperienceName.replace(/\s/g,""):"coachmark_module_v2",requestContext:r.requestContext,renderCoachmark:i&&i.isEcsExperiment?r.isECSFeatureFlagsEnabled(i.ecsFeatureFlags):t.renderCoachmark,isTmplStampingRequired:t.isTmplStampingRequired}),missingChildren:[]}};var Z=a("U6Xm"),Y=a("QnRU"),J=a("ljWX"),ee=a("9J8d"),te=a("dTwT"),ae=a("rvYQ"),re=a("WfnD"),ie=a("XLvf");class ne extends re.a{constructor(e,t,a,n,s,o,c){super(e,t,a,n,s,o,c),this.trackEventCallback=(e,t,a,r,i,n)=>{B.a&&B.a.sendActionEvent(t,i,n)},this.trackPartialImpressionCallback=(e,t,a,r)=>{B.a&&e&&B.a.observeElementTree(e)},this.trackAppErrorEventCallback=e=>{B.a&&B.a.sendAppErrorEvent(e)},this.reportEvent=(e,t,a,r,n)=>{this.coachmarkDataConnector?this.coachmarkDataConnector.reportEvent(e,t,a,r,n):this.trackAppErrorEventCallback(Object.assign(Object.assign({},i.O.CoachmarkDataConnectorUndefined),{message:"Error reporting iris telemetry due to undefined coachmark data connector.",pb:Object.assign(Object.assign({},i.O.CoachmarkDataConnectorUndefined.pb),{customMessage:`creativeId: ${r} placementId: ${n} irisAction: ${a} eventType: ${e} eventUrl: ${JSON.stringify(t)}`})}))},this.coachmarkPlaced=(e,t,a)=>Object(r.b)(this,void 0,void 0,(function*(){this.coachmarkDataConnector?Z.a.updateCoachmarkVisibleStatus.getActionSender(this.coachmarkDataConnector).send(!0):this.trackAppErrorEventCallback(Object.assign(Object.assign({},i.O.CoachmarkDataConnectorUndefined),{message:`Error reporting coachmark: ${e} status due to undefined coachmark data connector.`,pb:Object.assign(Object.assign({},i.O.CoachmarkDataConnectorUndefined.pb),{customMessage:`coachmark: ${e} creativeId: ${t} placementId: ${a}`})}))})),this.retrieveInitialEligibilityStateOfCampaignCallback=e=>!!e&&!0===Object(te.a)().getObject(e),this.isECSFeatureFlagsEnabled=e=>{if(!e||!this.configData)return!1;const t=e.split(",");for(const e in t)if(!this.configData[t[e]])return!1;return!0},this.removeCoachmarkFromPage=()=>W.a.removeCoachmarkFromPage.getActionSender(this).send(),this.updateCoachmark=()=>W.a.updateCoachmark.getActionSender(this).send(),this.timeoutTriggered=e=>W.a.timeoutOccurred.getActionSender(this).send(e),this.addCoachmarkMessages=e=>W.a.addCoachmarkMessages.getActionSender(this).send(e),this.hideCoachmark=()=>W.a.hideCoachmark.getActionSender(this).send(),ae.b&&ae.b.AppType&&ae.b.AppType===G.a.EdgeChromium&&(this.layoutDataConnector=ee.a.getInstance().rootReducer.connector(X.a.PageLayout))}onComponentConnect(e){return Object(r.b)(this,void 0,void 0,(function*(){yield re.a.prototype.onComponentConnect.call(this,e),e&&this.initializeCallbacks(e),this.updateTemplValueCallback||(this.updateTemplValueCallback=e=>{B.a.addOrUpdateTmplString(e)});const t=this.getCurrentState();if(t){const e=this.config&&this.config.messageList&&this.config.messageList.length>0;t.addCoachmarkToPage=e,t.messageIndex=e?0:-1,t.coachmarkMessageQueue=e?this.config.messageList:null}ee.a.getInstance().rootReducer.getDataConnector(X.a.CoachmarkData).then(e=>Object(r.b)(this,void 0,void 0,(function*(){e?(this.coachmarkDataConnector=e,ae.b&&ae.b.AppType&&ae.b.AppType===G.a.EdgeChromium&&(this.configData=yield Y.a.getConfigData(),this.layoutDataConnector||(this.layoutDataConnector=ee.a.getInstance().rootReducer.connector(X.a.PageLayout))),Z.a.addCoachmark.registerObserver(()=>{this.addCoachmarksToMessageQueue(e.getCurrentState().coachmarkMessages)}),e.getCoachmarks(J.d.MSNNewsCoachmark).then(e=>{this.addCoachmarksToMessageQueue(s.a.extractMessages(e))})):this.trackAppErrorEventCallback(Object.assign(Object.assign({},i.O.CoachmarkDataConnectorUndefined),{message:"Coachmark data connector is undefined"}))}))),W.a.readyToAddCoachmark.getActionSender(this).send()}))}mapStateToProps(e,t){const a={config:this.config,state:e,connectorArgs:{removeCoachmarkFromPage:this.removeCoachmarkFromPage,updateCoachmark:this.updateCoachmark,timeoutTriggered:this.timeoutTriggered,addCoachmarkMessages:this.addCoachmarkMessages,hideCoachmark:this.hideCoachmark,retrieveInitialEligibilityStateOfCampaign:this.retrieveInitialEligibilityStateOfCampaignCallback,trackEvent:this.trackEventCallback,trackPartialImpressionEvent:this.trackPartialImpressionCallback,trackAppErrorEvent:this.trackAppErrorEventCallback,telemetryObject:this.telemetryObject,updateTemplValue:this.updateTemplValueCallback,reportEvent:this.reportEvent,coachmarkPlaced:this.coachmarkPlaced,requestContext:this.requestContext,configData:this.configData,currentLayout:this.getCurrentPageLayout(),isECSFeatureFlagsEnabled:this.isECSFeatureFlagsEnabled}},r=K.inspect(a).props;return Object.assign(Object.assign({},t),r)}addCoachmarksToMessageQueue(e){e&&e.length>0&&(this.removeCoachmarkFromPage(),this.addCoachmarkMessages(e))}initializeCallbacks(e){Object(ie.isFunction)(e.trackEventCallback)&&(this.trackEventCallback=e.trackEventCallback),Object(ie.isFunction)(e.trackPartialImpressionCallback)&&(this.trackPartialImpressionCallback=e.trackPartialImpressionCallback),Object(ie.isFunction)(e.trackAppErrorEventCallback)&&(this.trackAppErrorEventCallback=e.trackAppErrorEventCallback),Object(ie.isFunction)(e.updateTemplValueCallback)&&(this.updateTemplValueCallback=e.updateTemplValueCallback)}getCurrentPageLayout(){this.layoutDataConnector&&this.layoutDataConnector.getLayoutStateAsync().then(e=>e?e.currentLayout:void 0)}}var se=a("qv6S");const oe=Object(V.a)(e=>{const t=e&&e.direction?e.direction:y.a.ltr;return{coachmark_default:{color:g.c,"background-color":b.c,"border-radius":Object(c.a)(4),"box-shadow":"0 12.8px 28.8px rgba(0,0,0,.22), 0 2.4px 7.2px rgba(0,0,0,.18)",left:"0",outline:"none",padding:`${Object(c.a)(16)} ${Object(c.a)(16)} ${Object(c.a)(16)} ${Object(c.a)(16)}`,position:"fixed",top:"0","z-index":(T.a.Flyout+50).toString(),[f.D]:{background:"WindowText",color:f.a.text}},coachmark_title:Object.assign({"grid-column":"2","grid-row":"1","letter-spacing":"0.6px","margin-bottom":"8px","line-height":"20px","text-align":Object(h.b)("left","right",t)},Object(k.d)()),coachmark_body:{"grid-column":"2","grid-row":"2","text-align":Object(h.b)("left","right",t),"line-height":"20px"},coachmark_ptr:{position:"absolute",fill:b.c},coachmark_close:{position:"absolute",width:Object(c.a)(24),height:Object(c.a)(24),"border-radius":"2px","&:hover":{"background-color":C.b,cursor:"pointer"},fill:g.c,top:Object(c.a)(4),[Object(h.b)("right","left",e.direction)]:Object(c.a)(4)},coachmark_leadImage:{float:Object(h.b)("left","right",t),"grid-column":"1","margin-right":Object(h.b)("16px","0px",t),"margin-left":Object(h.b)("0px","16px",t),width:"50px"},coachmark_mainImage:{margin:"-16px -16px 0 -16px",padding:"0 0 12px 0"},coachmark_ctaButton_container:{display:"grid","grid-template-columns":"1fr 8px 1fr","margin-top":"16px"},coachmark_ctaButton:{"grid-column":"1",height:"32px",background:Object(v.c)(b.c)(e),margin:"0px 8px 0px 0px","&:hover":{background:v.b},"border-radius":"2px","font-family":"Segoe UI","font-size":"12px","line-height":"16px",color:E.a,"border-width":"inherit"},coachmark_dismissButton:{"grid-column":"3",height:"32px",background:Object(O.c)(b.c)(e),margin:"0px 0px 0px 0px","&:hover":{background:O.b},"border-radius":"2px",float:"right","font-family":"Segoe UI","font-size":"12px","line-height":"16px",color:g.c,"border-width":"inherit"},coachmark_content:{display:"grid","grid-template-columns":"max-content auto"}}})(z),ce={reactComponent:oe,experienceConfigSchema:q.CoachmarkConfigSchema,defaultMockState:{},mockState:[{key:"preview",value:{}}],mockConfig:se.mockConfig,inspector:K.inspect}},bZQK:function(e,t){},qv6S:function(e,t){}}]);